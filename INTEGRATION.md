# Canvas & EdStem Integration Guide

This guide explains how to integrate the AI Tutor Agent with Canvas and EdStem for Professor Lipman's PHP 1510/2510 class.

## Canvas Integration

### Option 1: Download Materials via API (Recommended)

1. **Get Canvas API Token:**
   - Go to Canvas → Account → Settings
   - Scroll to "Approved Integrations"
   - Click "+ New Access Token"
   - Copy token

2. **Add to .env:**
   ```env
   CANVAS_API_TOKEN=your_token_here
   CANVAS_BASE_URL=https://canvas.brown.edu
   ```

3. **Find Course ID:**
   - Go to your course on Canvas
   - URL will be: `https://canvas.brown.edu/courses/12345`
   - The number (12345) is your course ID

4. **Download Materials:**
   ```bash
   python scripts/canvas_downloader.py --course-id YOUR_COURSE_ID
   ```

5. **Re-index:**
   ```bash
   python scripts/ingest_docs.py
   ```

### Option 2: Manual Download

1. Download files from Canvas manually
2. Organize into folders:
   - Slides → `docs/`
   - Homework/Quizzes → `assessments/`
   - Data files → `data/`
3. Run `python scripts/ingest_docs.py`

### Option 3: Embed in Canvas (LTI App)

To embed the Streamlit app directly in Canvas:

1. **Deploy to Streamlit Cloud:**
   - Push code to GitHub
   - Go to [share.streamlit.io](https://share.streamlit.io)
   - Connect repo and deploy

2. **Create LTI App in Canvas:**
   - Go to Course Settings → Apps → View App Configurations
   - Add App → By URL
   - Configuration URL: Your Streamlit app URL
   - Consumer Key/Secret: Generated by Streamlit (if using LTI)

3. **Add to Course Navigation:**
   - Course Settings → Navigation
   - Drag "AI Tutor" to enabled items

## EdStem Integration

### Option 1: Share Link

1. Deploy app to Streamlit Cloud
2. Share the link in EdStem:
   - Post in course announcements
   - Add to course resources page
   - Include in assignment descriptions

### Option 2: Embed as iframe

If EdStem supports iframes:

```html
<iframe src="https://your-app.streamlit.app" width="100%" height="800px"></iframe>
```

### Option 3: Direct Integration (Advanced)

If EdStem has API access:
- Create EdStem API integration script (similar to Canvas downloader)
- Pull course materials directly
- Sync with EdStem discussions

## Recommended Workflow

### Initial Setup (Once)

1. ✅ Download all course materials from Canvas
2. ✅ Download textbook chapters (if available as PDFs)
3. ✅ Gather sample assessment solutions
4. ✅ Add key datasets from labs
5. ✅ Run ingestion: `python scripts/ingest_docs.py`
6. ✅ Test the agent locally
7. ✅ Deploy to Streamlit Cloud

### Weekly Updates

1. Download new lecture slides → `docs/`
2. Download new homework/quizzes → `assessments/`
3. Add new datasets → `data/`
4. Run `python scripts/ingest_docs.py` to update index
5. Redeploy to Streamlit (if needed)

### Student Workflow

1. Students access agent via Canvas link or EdStem
2. Choose mode (Conversation/Assessment/Article Analysis)
3. Ask questions or practice
4. Export chat to PDF for review
5. Share questions/issues on EdStem

## Article Sources

### BruKnow Library

1. Students search: https://bruknow.library.brown.edu
2. Keywords: "biostatistics", "public health", "nature", "vaccines"
3. Download PDFs
4. Upload to agent or use article analysis mode

### Nature.com

1. Access via Brown library (automatic login)
2. Search public health articles
3. Download PDFs
4. Analyze in agent

### Processing Articles

```bash
# For arXiv articles
python scripts/article_processor.py https://arxiv.org/abs/2301.00001

# For other URLs, download manually and place in articles/ folder
```

## Best Practices

### For Instructors

- ✅ Regularly update materials (weekly)
- ✅ Monitor agent responses for accuracy
- ✅ Adjust prompts in `app.py` as needed
- ✅ Collect anonymized feedback from students
- ✅ Track which concepts students struggle with

### For Students

- ✅ Use conversation mode for concept questions
- ✅ Use assessment mode for practice
- ✅ Use article analysis for research papers
- ✅ Export chats for review
- ✅ Share feedback on EdStem

## Troubleshooting

### Canvas API Issues

- **401 Unauthorized**: Check API token
- **404 Not Found**: Verify course ID
- **Files not downloading**: Some files may require manual download

### EdStem Integration

- **Link not working**: Check Streamlit app is deployed
- **Iframe blocked**: Use direct link instead
- **Access issues**: Verify students have link

## Support

For integration help:
- Check [SETUP.md](SETUP.md) for basic setup
- Canvas API docs: https://canvas.instructure.com/doc/api/
- Streamlit deployment: https://docs.streamlit.io/streamlit-community-cloud

